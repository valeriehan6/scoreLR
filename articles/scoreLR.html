<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="scoreLR">
<title>scoreLR • scoreLR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="scoreLR">
<meta property="og:description" content="scoreLR">
<meta property="og:image" content="https://valeriehan6.github.io/scoreLR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">scoreLR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/scoreLR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>scoreLR</h1>
            
      
      
      <div class="d-none name"><code>scoreLR.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h3>
<p>Score-based likelihood ratios (SLRs) are a statistical method used to
quantify the weight of evidence and have been used in many forensic
disciplines. Using the context of footwear evidence to make the problem
more concrete, similarity/dissimilarity scores are computed from pairs
of shoeprints. Note that there is a dependence between scores that share
a shoeprint or shoe in common. Given up to 5 similarity/dissimilarity
scores, we include four different methods of computing the SLR that
address the dependence. We also provide a visualization of the resulting
SLR using an ROC curve. More information can be found on the
corresponding <a href="https://github.com/valeriehan6/scoreLR" class="external-link">Github
repository</a>.</p>
</div>
<div class="section level3">
<h3 id="slrs">SLRs<a class="anchor" aria-label="anchor" href="#slrs"></a>
</h3>
<p>Score-based likelihood ratios (SLRs) are used to determine the
strength of evidence for a particular source proposition. Typically,
they aim to quantify the similarity between an item found at a crime
scene and a reference item with a known origin. The score measures the
degree of similarity by analyzing one or more features of the items
being compared. To assess the probative value of the evidence, examiners
estimate the distributions of the score under two competing propositions
using experimental pairs of items with a known origin. However, using
items from the same source to build these distributions can result in
score dependence. This dependence can affect the accuracy of the SLR as
a classifier. To address this issue, Han (2022) explored methods to
improve the performance of the SLR where kernel density estimation (KDE)
was used to estimate the SLR. There, performance was measured based on
accuracy, true positive rate, true negative rate, and the rate of weak
or misleading evidence with the average features method showing
significantly better performance in three out of four performance
criteria compared to default methods.</p>
</div>
<div class="section level3">
<h3 id="using-slr-with-footwear-evidence">Using SLR with Footwear Evidence<a class="anchor" aria-label="anchor" href="#using-slr-with-footwear-evidence"></a>
</h3>
<p>Take the following hypothetical scenario. Shoeprints are discovered
and crime scene investigators obtain images of those prints.
Additionally, high-quality impressions of a suspect’s shoe outsole are
available to the forensic scientist. The question of interest is whether
the suspect’s shoe could have produced the prints at the crime scene. To
answer this question, we can rephrase the problem as a test of two
propositions: <span class="math inline">\(H_p\)</span>: The shoeprints
at the crime scene were made by the suspect’s shoe. <span class="math inline">\(H_d\)</span>: The shoeprints at the crime scene
were made by someone else’s shoe.</p>
</div>
<div class="section level3">
<h3 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h3>
<p>Given scores <span class="math inline">\(s_1 .. s_k\)</span> where
each <span class="math inline">\(s_i\)</span> is computed from a pair of
shoeprints, the SLR is defined as</p>
<p><span class="math display">\[ SLR = \frac {f(s_1, . . . , s_k|H_p)}
{f(s_1, . . . , s_k|H_d)}\]</span> where <span class="math inline">\(f(s_1, . . . , s_k|H_p)\)</span> and <span class="math inline">\(f(s_1, . . . , s_k|H_d)\)</span> are estimated
densities for the scores <span class="math inline">\(s_1 .. s_k\)</span>
under the two different hypotheses. Since the scores do not obviously
follow any known distribution, kernel density estimation (KDE) is used
to estimate the KM and KNM distributions. However, KDE assumes that the
scores are independent. Scores computed from pairs of images are not
independent because images of the same shoe appear in multiple pairs.
For details about the data refer to the data section. There are four
proposed methods to deal with this dependence issue. The first method is
to ignore the fact that the observations cannot be assumed to be
independent and implement KDE using all available scores. This method is
labeled <code>ignore_dep</code>. Another is to remove the dependence in
the dataset that is used to estimate a KDE and to reduce the sample to
the largest independent subset of pairs. We call this the
<code>strict_indep_set</code>. In the third approach, we create multiple
random independent subsets of the training dataset and implement KDE in
each subset. This method is called <code>multiple_kde</code>. In the
last method, we average over the scans that correspond to the same pair
of shoes. Here the actual pairs of shoes included in the dataset are
independent. This is called <code>average_features</code>.
<!-- still need to read the above paragraph --></p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="the-data">The Data<a class="anchor" aria-label="anchor" href="#the-data"></a>
</h2>
<p>This package includes a dataset called <code>shoedata</code>. We use
a large set of footwear outsole images collected by the Center for
Statistics and Applications in Forensic Evidence (CSAFE). One hundred
and forty-seven pairs of worn shoes, each scanned four times, were
included in that dataset. A subset are included in the package. Note
each row corresponds to a pair of scans.</p>
<p>The data in this package is a data frame with 926 rows and 7
variables:</p>
<ul>
<li>
<code>source1</code>: shoe identifier for the first shoe, left (L)
or right (R)</li>
<li>
<code>dep1</code>: pair identifier for the first shoe</li>
<li>
<code>source2</code>: shoe identifier for the second shoe, left (L)
or right (R)</li>
<li>
<code>dep2</code>: pair identifier for the second shoe</li>
<li>
<code>clique_size</code>: score; size of the maximal clique</li>
<li>
<code>med_dist_euc</code>: score; median Euclidean distance between
overlapping pixels</li>
<li>
<code>input_overlap</code>: score; proportion of overlapping pixels
in the aligned images</li>
</ul>
<p>For an example of what the original data looks like, refer to example
section.</p>
<div class="section level3">
<h3 id="inputting-new-data">Inputting New Data:<a class="anchor" aria-label="anchor" href="#inputting-new-data"></a>
</h3>
<p>You can choose to import your own dataset, but it must be of a
specific format with specific names.</p>
<p>Your data should include:</p>
<ul>
<li>
<code>source1</code>: identifier for the first item</li>
<li>
<code>dep1</code>: pair identifier for the first item</li>
<li>
<code>source2</code>: identifier for the second item</li>
<li>
<code>dep2</code>: pair identifier for the second item</li>
<li>You can include up to five columns of scores where each column
represents a different “function” (like euclidean, basic difference,
deviation, etc). These do not have to be named something specific.</li>
</ul>
<p>If sources match, then that row will be labeled as a known match and
if sources do not match, it will be labeled as a known-non match.
<!-- need to add something about function of dep1 and dep2 --></p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h2>
<p>This package has seven main functions and three helper functions.</p>
<div class="section level4">
<h4 id="dep_split">dep_split<a class="anchor" aria-label="anchor" href="#dep_split"></a>
</h4>
<p>This function creates a train/test split for datasets with
dependencies. You can specify the train/test split proportion
<code>p</code>. Note <code>p</code> is between 0 and 1.</p>
</div>
<div class="section level4">
<h4 id="slr_results">slr_results<a class="anchor" aria-label="anchor" href="#slr_results"></a>
</h4>
<p>This function is essentially a wrapper function that computes the
results of various methods given a dataframe with the train/test split
already done.</p>
</div>
<div class="section level4">
<h4 id="plot_slr_roc">plot_slr_roc<a class="anchor" aria-label="anchor" href="#plot_slr_roc"></a>
</h4>
<p>This function plots the ROC curve for a given method. The ROC curve
is created by plotting the true positive rate against the false positive
rate at various threshold settings.</p>
</div>
<div class="section level3">
<h3 id="methods-functions">Methods Functions<a class="anchor" aria-label="anchor" href="#methods-functions"></a>
</h3>
<div class="section level4">
<h4 id="ignore_dep">1. ignore_dep<a class="anchor" aria-label="anchor" href="#ignore_dep"></a>
</h4>
<p>This function returns an SLR evaluation for the ignore dependence
method. This method, like the name suggests, ignores that multivariate
observations cannot be assumed to be independent, and performs kernel
density estimation (KDE) using all available scores.</p>
</div>
<div class="section level4">
<h4 id="strict_indep_set">2. strict_indep_set<a class="anchor" aria-label="anchor" href="#strict_indep_set"></a>
</h4>
<p>This function returns a SLR evaluation for the strict independence
set. To use this method, we perform KDE on an independent subset of
scores. (Note that independence here means that each source only appears
in one pair.) The resulting dataset is much smaller than the original
sample.</p>
</div>
<div class="section level4">
<h4 id="avg_features">3. avg_features<a class="anchor" aria-label="anchor" href="#avg_features"></a>
</h4>
<p>This function returns a SLR evaluation for the average features
method. This method averages over the rows that correspond to the same
pairs of sources. This results in an independent set of multivariate
scores.</p>
</div>
<div class="section level4">
<h4 id="multiple_kde">4. multiple_kde<a class="anchor" aria-label="anchor" href="#multiple_kde"></a>
</h4>
<p>This function returns a SLR evaluation for the multiple KDE method.
This method creates multiple random independent subsets of the training
dataset and implements KDE in each subset.</p>
</div>
</div>
<div class="section level3">
<h3 id="helper-functions">Helper Functions<a class="anchor" aria-label="anchor" href="#helper-functions"></a>
</h3>
<div class="section level4">
<h4 id="opt_thresh">opt_thresh<a class="anchor" aria-label="anchor" href="#opt_thresh"></a>
</h4>
<p>This function returns an optimal threshold for the SLR. Optimality
here is defined as minimizing the absolute difference between the true
positive and true negative rates.</p>
</div>
<div class="section level4">
<h4 id="indep_km_set">indep_km_set<a class="anchor" aria-label="anchor" href="#indep_km_set"></a>
</h4>
<p>This function returns an independent KM set of the training data
using <code>seed</code>.</p>
</div>
<div class="section level4">
<h4 id="indep_knm_set">indep_knm_set<a class="anchor" aria-label="anchor" href="#indep_knm_set"></a>
</h4>
<p>This function returns an independent KNM set of the data using
<code>seed</code>.</p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="using-scorelr">Using scoreLR<a class="anchor" aria-label="anchor" href="#using-scorelr"></a>
</h2>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>You can install the development version of scoreLR like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"https://github.com/valeriehan6/scoreLR"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="load-library">Load Library<a class="anchor" aria-label="anchor" href="#load-library"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://valeriehan6.github.io/scoreLR/">scoreLR</a></span><span class="op">)</span></span></code></pre></div>
<p>There are a couple of ways to use this package.</p>
<p>You can: * Use any of the methods to get SLR values * Plot the ROC
curve of any of the methods * Compare methods</p>
</div>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>First read in your data. Note your data must follow the
specifications outlined in the data section.</p>
<p>The dataset included in the package <code>shoedata</code> is
displayed below.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">shoedata</span><span class="op">)</span></span>
<span><span class="co">#&gt;   source1 dep1 source2 dep2 clique_size med_dist_euc input_overlap</span></span>
<span><span class="co">#&gt; 1     1_L    1     1_L    1           6      1.81890         0.218</span></span>
<span><span class="co">#&gt; 2     1_L    1     1_L    1           6      1.41041         0.200</span></span>
<span><span class="co">#&gt; 3     1_L    1     1_L    1           6      1.80102         0.102</span></span>
<span><span class="co">#&gt; 4     1_L    1     1_L    1           8      1.08331         0.258</span></span>
<span><span class="co">#&gt; 5     1_L    1     1_L    1           5      1.93781         0.008</span></span>
<span><span class="co">#&gt; 6     1_L    1     1_L    1          12      0.91193         0.400</span></span></code></pre></div>
<p>Then, you can use the <code>dep_split</code> function to separate
your data into training and test data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shoedata_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dep_split.html">dep_split</a></span><span class="op">(</span><span class="va">shoedata</span>, <span class="fl">0.75</span>, seed <span class="op">=</span> <span class="fl">20230506</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">shoedata_split</span><span class="op">)</span></span>
<span><span class="co">#&gt;   source1 dep1 source2 dep2 clique_size med_dist_euc input_overlap train</span></span>
<span><span class="co">#&gt; 1   103_L  103   103_L  103           9      1.11631         0.420  TRUE</span></span>
<span><span class="co">#&gt; 2   103_L  103   103_L  103           6      1.32526         0.372  TRUE</span></span>
<span><span class="co">#&gt; 3   103_L  103   103_L  103           5      1.55036         0.186  TRUE</span></span>
<span><span class="co">#&gt; 4   103_L  103   103_L  103          10      0.89472         0.472  TRUE</span></span>
<span><span class="co">#&gt; 5   103_L  103   103_L  103           5      1.29865         0.006  TRUE</span></span>
<span><span class="co">#&gt; 6   103_L  103   103_L  103           6      0.88348         0.160  TRUE</span></span></code></pre></div>
<p>Then you can calculate SLRs based on any of the four methods by
specifying which of the four methods you’d like to run. The default is
all four methods. We display this below.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/slr_results.html">slr_results</a></span><span class="op">(</span><span class="va">shoedata_split</span>, </span>
<span>                       method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IgnoreDependence"</span>, <span class="st">"StrictIndependentSet"</span>,</span>
<span>                                  <span class="st">"AverageFeatures"</span>, <span class="st">"MultipleKDE"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ROC_values not calculated8, 14"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ IgnoreDependence    :List of 5</span></span>
<span><span class="co">#&gt;   ..$ KM_SLR    :'data.frame':   48 obs. of  1 variable:</span></span>
<span><span class="co">#&gt;   .. ..$ SLR: num [1:48] Inf Inf 8.43e+66 Inf 4.63e-03 ...</span></span>
<span><span class="co">#&gt;   ..$ KNM_SLR   :'data.frame':   146 obs. of  1 variable:</span></span>
<span><span class="co">#&gt;   .. ..$ SLR: num [1:146] 0.003376 0.000408 0.001219 0.00171 0.012593 ...</span></span>
<span><span class="co">#&gt;   ..$ threshold : num 0.0167</span></span>
<span><span class="co">#&gt;   ..$ new_SLR   : logi NA</span></span>
<span><span class="co">#&gt;   ..$ ROC_values:'data.frame':   154 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ tpr: num [1:154] 0 0.0625 0.125 0.1875 0.25 ...</span></span>
<span><span class="co">#&gt;   .. ..$ fpr: num [1:154] 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ StrictIndependentSet:List of 5</span></span>
<span><span class="co">#&gt;   ..$ KM_SLR    :'data.frame':   48 obs. of  1 variable:</span></span>
<span><span class="co">#&gt;   .. ..$ SLR: num [1:48] Inf Inf Inf Inf 0.000527 ...</span></span>
<span><span class="co">#&gt;   ..$ KNM_SLR   :'data.frame':   146 obs. of  1 variable:</span></span>
<span><span class="co">#&gt;   .. ..$ SLR: num [1:146] 0.015403 0.000293 0.006089 0.000237 0.037827 ...</span></span>
<span><span class="co">#&gt;   ..$ threshold : num 0.0115</span></span>
<span><span class="co">#&gt;   ..$ new_SLR   : logi NA</span></span>
<span><span class="co">#&gt;   ..$ ROC_values:'data.frame':   142 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ tpr: num [1:142] 0 0.143 0.143 0.286 0.286 ...</span></span>
<span><span class="co">#&gt;   .. ..$ fpr: num [1:142] 0 0 0.00709 0.00709 0.01418 ...</span></span>
<span><span class="co">#&gt;  $ AverageFeatures     :List of 5</span></span>
<span><span class="co">#&gt;   ..$ KM_SLR    :'data.frame':   8 obs. of  1 variable:</span></span>
<span><span class="co">#&gt;   .. ..$ SLR: num [1:8] Inf Inf Inf Inf Inf ...</span></span>
<span><span class="co">#&gt;   ..$ KNM_SLR   :'data.frame':   14 obs. of  1 variable:</span></span>
<span><span class="co">#&gt;   .. ..$ SLR: num [1:14] 6.21e-03 2.70e-03 9.51e-03 4.66e+08 2.43e-04 ...</span></span>
<span><span class="co">#&gt;   ..$ threshold : num 0.553</span></span>
<span><span class="co">#&gt;   ..$ new_SLR   : logi NA</span></span>
<span><span class="co">#&gt;   ..$ ROC_values: logi NA</span></span>
<span><span class="co">#&gt;  $ MultipleKDE         :List of 5</span></span>
<span><span class="co">#&gt;   ..$ KM_SLR    :'data.frame':   48 obs. of  1 variable:</span></span>
<span><span class="co">#&gt;   .. ..$ SLR: num [1:48] Inf Inf 1.86e+86 Inf 8.48e-03 ...</span></span>
<span><span class="co">#&gt;   ..$ KNM_SLR   :'data.frame':   146 obs. of  1 variable:</span></span>
<span><span class="co">#&gt;   .. ..$ SLR: num [1:146] 0.005451 0.000995 0.00399 0.002823 0.017074 ...</span></span>
<span><span class="co">#&gt;   ..$ threshold : num 0.0217</span></span>
<span><span class="co">#&gt;   ..$ new_SLR   : logi NA</span></span>
<span><span class="co">#&gt;   ..$ ROC_values:'data.frame':   150 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ tpr: num [1:150] 0 0.0833 0.1667 0.25 0.3333 ...</span></span>
<span><span class="co">#&gt;   .. ..$ fpr: num [1:150] 0 0 0 0 0 ...</span></span></code></pre></div>
<p>The output gives you a list. Each element corresponds to the output
of the corresponding method function.</p>
<p>You can also choose to run the method itself after splitting the data
by training/test sets and KM/KNM.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Split data</span></span>
<span><span class="va">KM_train</span> <span class="op">&lt;-</span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">shoedata_split</span>, <span class="va">source1</span> <span class="op">==</span> <span class="va">source2</span> <span class="op">&amp;</span> <span class="va">train</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">KM_test</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">shoedata_split</span>, <span class="va">source1</span> <span class="op">==</span> <span class="va">source2</span> <span class="op">&amp;</span> <span class="va">train</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">KNM_train</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">shoedata_split</span>, <span class="va">source1</span> <span class="op">!=</span> <span class="va">source2</span> <span class="op">&amp;</span> <span class="va">train</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">KNM_test</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">shoedata_split</span>, <span class="va">source1</span> <span class="op">==</span> <span class="va">source2</span> <span class="op">&amp;</span> <span class="va">train</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ignoring dependence method</span></span>
<span><span class="va">ignoredep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ignore_dep.html">ignore_dep</a></span><span class="op">(</span><span class="va">KM_train</span>, <span class="va">KM_test</span>, <span class="va">KNM_train</span>, <span class="va">KNM_test</span><span class="op">)</span></span></code></pre></div>
<p>You can extract the SLR values for <code>KM_test</code> and
<code>KNM_test</code> from the output. Note that you can calculate the
accuracy and other performance metrics by specifying a threshold (e.g.,
1 or the optimal threshold calculated from the training data).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># KM and KNM SLR values for the test data</span></span>
<span><span class="va">KM_SLR_test</span> <span class="op">&lt;-</span> <span class="va">ignoredep</span><span class="op">$</span><span class="va">KM_SLR</span></span>
<span><span class="va">KNM_SLR_test</span> <span class="op">&lt;-</span> <span class="va">ignoredep</span><span class="op">$</span><span class="va">KNM_SLR</span></span>
<span></span>
<span><span class="co"># optimal threshold</span></span>
<span><span class="va">thresh</span> <span class="op">&lt;-</span> <span class="va">ignoredep</span><span class="op">$</span><span class="va">threshold</span></span>
<span></span>
<span><span class="co"># accuracy</span></span>
<span><span class="va">tp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">KM_SLR_test</span> <span class="op">&gt;</span> <span class="va">thresh</span><span class="op">)</span></span>
<span><span class="va">tn</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">KNM_SLR_test</span> <span class="op">&lt;</span> <span class="va">thresh</span><span class="op">)</span></span>
<span><span class="va">accuracy</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tp</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tn</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tp</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tn</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># true positive rate</span></span>
<span><span class="va">tpr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tp</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># true negative rate</span></span>
<span><span class="va">tnr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tn</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tn</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># rate of weak/misleading evidence</span></span>
<span><span class="va">rwme</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">KM_SLR_test</span> <span class="op">&lt;</span> <span class="fl">100</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">KNM_SLR_test</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">/</span></span>
<span>  <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">KM_SLR_test</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">KNM_SLR_test</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># you can choose to use a value other than 100</span></span></code></pre></div>
<p>You can also plot the ROC curves using <code>plot_slr_roc</code>. Due
to randomness in the train/test split and in choosing independent sets,
each run may produce a different ROC curve, so we allow the user to plot
multiple runs. <code>alpha</code> corresponds to the transparency
parameter in the <code>ggplot2</code> package. Increase
<code>alpha</code> if the lines are too faint.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_slr_roc.html">plot_slr_roc</a></span><span class="op">(</span><span class="va">shoedata</span>, p <span class="op">=</span> <span class="fl">0.75</span>, method <span class="op">=</span> <span class="st">"IgnoreDependence"</span>, </span>
<span>             num_runs <span class="op">=</span> <span class="fl">20</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p><img src="scoreLR_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>The method functions and <code>slr_results</code> can also estimate
the SLR for data where the ground truth is unknown as long as training
data is provided.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example unknown data</span></span>
<span><span class="va">unknown</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>clique_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">8</span><span class="op">)</span>, med_dist_euc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.9</span>, <span class="fl">1.1</span><span class="op">)</span>, </span>
<span>                      input_overlap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.01</span>, <span class="fl">0.26</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/strict_indep_set.html">strict_indep_set</a></span><span class="op">(</span><span class="va">KM_train</span>, <span class="va">KM_test</span>, <span class="va">KNM_train</span>, <span class="va">KNM_test</span>, <span class="va">unknown</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">new_SLR</span></span>
<span><span class="co">#&gt;           SLR</span></span>
<span><span class="co">#&gt; 1 0.001280425</span></span>
<span><span class="co">#&gt; 2         Inf</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="future-work">Future Work<a class="anchor" aria-label="anchor" href="#future-work"></a>
</h2>
<p>There are a couple things we would like to implement in the
future.</p>
<ul>
<li>Include the final method in Classification performance of
score-based likelihood ratios when data exhibit various degrees of
dependence.</li>
<li>Allow for different definitions of optimality.</li>
<li>Add more helper functions since the method functions have a lot of
code in common.</li>
<li>Enable people to upload their own data to the Shiny App.</li>
<li>Have a wrapper function that allows users to input data that doesn’t
have the column names we specify here.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Valerie Han, Marie Hardt, Anyesha Ray.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
